<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <base href="/nimbus/">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#0b1220" />
    <title>Nimbus</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/nimbus/vite.svg" />

    <!-- Font (Inter) -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <!-- App bundle produced by Vite (keep these 2 lines as they are in your repo) -->
    <script type="module" crossorigin src="/nimbus/assets/index-DU6uUfo0.js"></script>
    <link rel="stylesheet" crossorigin href="/nimbus/assets/index-984FJjwG.css">

    <!-- HARD FALLBACK STYLES: dark theme + backdrop; always applied -->
    <style>
      html, body, #root { min-height: 100%; }
      body {
        margin: 0;
        background: #0b1220;           /* deep slate */
        color: #e6edf3;                /* soft light */
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      }
      /* Subtle symbolic “cloud” backdrop */
      .nimbus-backdrop {
        position: fixed; inset: 0; pointer-events: none;
        background:
          radial-gradient(1200px 600px at 18% 12%, rgba(54,208,196,0.08), transparent),
          radial-gradient(1100px 700px at 82% 88%, rgba(126,83,212,0.06), transparent),
          linear-gradient(180deg, rgba(13,23,42,0.55), rgba(13,23,42,0.55));
      }

      /* SVG labels: bright with subtle outline (halo) */
      svg text {
        paint-order: stroke;
        stroke: #0b1220;
        stroke-width: 3;
        stroke-opacity: .8;
        fill: #f8fafc;
      }

      /* Brighten all slate text classes generated by Tailwind/Vite */
      [class*="text-slate-"] { color: #cbd5e1 !important; }   /* general lift */
      .text-slate-200, .text-slate-50 { color: #e6edf3 !important; }
      h1, h2, h3 { color: #e6edf3 !important; letter-spacing: .2px; }

      /* Legend styling */
      .nimbus-legend {
        display:flex; flex-wrap:wrap; gap:12px;
        color:#cbd5e1; font-size:12px; margin-top:12px;
      }
      .nimbus-legend .dot {
        display:inline-block; width:12px; height:12px; border-radius:9999px;
      }
    </style>
  </head>

  <body>
    <!-- Backdrop always rendered -->
    <div class="nimbus-backdrop" aria-hidden></div>

    <div id="root"></div>

    <!-- Legend patch: inserts a clean legend that matches thresholds/colours -->
    <script>
      (function enhanceLegend() {
        function insertWhenReady() {
          const root = document.getElementById('root');
          if (!root) return setTimeout(insertWhenReady, 150);

          // Find the first SVG (the Atlas)
          const svg = root.querySelector('svg');
          if (!svg) return setTimeout(insertWhenReady, 150);

          // Remove any existing legend that mentions "Link thickness"
          Array.from(root.querySelectorAll('div'))
            .filter(el => /Link thickness/i.test(el.textContent || ''))
            .forEach(el => el.remove());

          // Avoid duplicates
          if (document.querySelector('.nimbus-legend')) return;

          // Insert legend after the SVG's container
          const container = svg.closest('div') || root;
          const legend = document.createElement('div');
          legend.className = 'nimbus-legend';
          legend.innerHTML = `
            <div class="flex items-center gap-2"><span class="dot" style="background:#36D0C4"></span> Calm (≥85)</div>
            <div class="flex items-center gap-2"><span class="dot" style="background:#E5B769"></span> Variable (70–84)</div>
            <div class="flex items-center gap-2"><span class="dot" style="background:#F87171"></span> Storm (&lt;70)</div>
            <div class="flex items-center gap-2"><span style="display:inline-block;width:24px;height:2px;background:#cbd5e1"></span> Link thickness = symbolic mass</div>
          `;
          container.parentNode.insertBefore(legend, container.nextSibling);
        }
        // Try a few times while React mounts/hydrates
        for (let i = 0; i < 20; i++) setTimeout(insertWhenReady, 150 * i);
      })();
    </script>
  </body>
</html>
