<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <base href="/nimbus/">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b1220" />
  <title>Nimbus</title>

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/nimbus/vite.svg" />

  <!-- Inter font -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

  <!-- Vite bundle (keep paths as-is from your build) -->
  <script type="module" crossorigin src="/nimbus/assets/index-DU6uUfo0.js"></script>
  <link rel="stylesheet" crossorigin href="/nimbus/assets/index-984FJjwG.css">

  <!-- Hard fallback styles: dark theme + backdrop -->
  <style>
    html, body, #root { min-height: 100%; }

    body {
      margin: 0;
      background: #0b1220; /* deep slate */
      color: #e6edf3;      /* soft light */
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }

    /* Subtle “cloud” backdrop */
    .nimbus-backdrop {
      position: fixed;
      inset: 0;
      pointer-events: none;
      background:
        radial-gradient(1200px 600px at 18% 12%, rgba(54,208,196,0.08), transparent),
        radial-gradient(1100px 700px at 82% 88%, rgba(126,83,212,0.06), transparent),
        linear-gradient(180deg, rgba(13,23,42,0.55), rgba(13,23,42,0.55));
    }

    /* SVG labels: bright with subtle outline (halo) */
    #root svg text {
      paint-order: stroke;
      stroke: #0b1220;
      stroke-width: 3;
      stroke-opacity: .8;
      fill: #f8fafc;
    }

    /* Brighten slate text classes generated by Tailwind/Vite */
    [class*="text-slate-"] { color: #cbd5e1 !important; } /* general lift */
    .text-slate-200, .text-slate-50 { color: #e6edf3 !important; }
    h1, h2, h3 { color: #e6edf3 !important; letter-spacing: .2px; }

    /* Legend styling */
    .nimbus-legend {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      color: #cbd5e1;
      font-size: 12px;
      margin-top: 12px;
    }
    .nimbus-legend .dot {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 9999px;
    }

    /* ===== Nimbus “Pro Dashboard” polish ============================= */

    /* 1) Glass cards: target the big rounded containers the app renders */
    .rounded-xl,
    .bg-slate-900\/60,
    .bg-slate-900\/70,
    .bg-slate-900\/80 {
      background: rgba(8, 13, 24, 0.72) !important;          /* deep glass */
      border-color: rgba(148, 163, 184, 0.20) !important;     /* subtle line */
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      box-shadow:
        0 10px 30px rgba(3, 7, 18, 0.55),
        inset 0 1px 0 rgba(255, 255, 255, 0.03);
    }

    /* Small cards (metric tiles) – a touch more depth */
    .card,
    [class*="CardContent"] {
      background: rgba(10, 16, 28, 0.78);
      border: 1px solid rgba(148, 163, 184, 0.18);
      box-shadow: 0 6px 16px rgba(2, 6, 23, 0.45);
    }

    /* 2) Atlas: node glow + hover and calm pulse */
    #root svg circle {
      transition: transform .25s ease, filter .25s ease, opacity .25s ease;
    }

    /* Hover: gently lift the node */
    #root svg g:hover circle:first-of-type {
      transform: scale(1.05);
      filter: drop-shadow(0 0 10px rgba(34,211,238,.55));
    }

    /* Calm nodes (cyan fill) get a slow pulse */
    #root svg circle[fill="#36D0C4"] {
      animation: nimbusPulse 3s ease-in-out infinite;
    }
    @keyframes nimbusPulse {
      0%, 100% { filter: drop-shadow(0 0 0 rgba(54,208,196,0)); }
      50%      { filter: drop-shadow(0 0 12px rgba(54,208,196,.55)); }
    }

    /* 3) Typography: make dashboard text clearer */
    h1 { font-weight: 500; letter-spacing: .3px; }
    h2 { font-weight: 500; letter-spacing: .25px; }
    h3 { font-weight: 500; letter-spacing: .2px; }

    .small, .text-xs { font-size: 12.5px !important; }
    .text-sm { font-size: 14.5px !important; }

    /* Ensure SVG label size is readable on all screens */
    #root svg { font-size: 13px; }

    /* 4) Mobile tuning */
    @media (max-width: 640px) {
      body { font-size: 15px; }
      h1 { font-size: 22px !important; }
      h2 { font-size: 18px !important; }
      .nimbus-legend { font-size: 12.5px; gap: 10px; }

      /* Compress Atlas margins a touch for small screens */
      .rounded-xl { padding: 14px !important; }
    }

    /* 5) Divider polish for the details panel */
    hr, .border-t {
      border-top-color: rgba(148,163,184,0.18) !important;
      opacity: 1;
    }

    /* 6) Buttons: make outlines visible on dark */
    button, .btn, [class*="button"] {
      border-color: rgba(148,163,184,0.28) !important;
    }
  </style>
</head>

<body>
  <!-- Backdrop always rendered -->
  <div class="nimbus-backdrop" aria-hidden="true"></div>

  <div id="root"></div>

  <!-- Legend patch: inserts a clean legend that matches thresholds/colours -->
  <script>
    (function enhanceLegend() {
      function insertWhenReady(attempt = 0) {
        const root = document.getElementById('root');
        if (!root) return schedule(attempt);

        // Find the first SVG (the Atlas) within the app root
        const svg = root.querySelector('svg');
        if (!svg) return schedule(attempt);

        // Remove any existing legend rows that mention "Link thickness"
        root.querySelectorAll('div').forEach(el => {
          if (/(^|\s)Link thickness(\s|=|$)/i.test(el.textContent || '')) el.remove();
        });

        // Avoid duplicate legends
        if (root.querySelector('.nimbus-legend')) return;

        // Insert legend after the SVG's nearest container
        const container = svg.closest('div') || root;
        const legend = document.createElement('div');
        legend.className = 'nimbus-legend';
        legend.innerHTML = `
          <div class="flex items-center gap-2">
            <span class="dot" style="background:#36D0C4"></span> Calm (≥85)
          </div>
          <div class="flex items-center gap-2">
            <span class="dot" style="background:#E5B769"></span> Variable (70–84)
          </div>
          <div class="flex items-center gap-2">
            <span class="dot" style="background:#F87171"></span> Storm (&lt;70)
          </div>
          <div class="flex items-center gap-2">
            <span style="display:inline-block;width:24px;height:2px;background:#cbd5e1"></span>
            Link thickness = symbolic mass
          </div>
        `;

        container.parentNode.insertBefore(legend, container.nextSibling);
      }

      function schedule(attempt) {
        if (attempt >= 20) return;
        setTimeout(() => insertWhenReady(attempt + 1), 150);
      }

      // Try a few times while React mounts/hydrates
      insertWhenReady(0);
    })();
  </script>
</body>
</html>
